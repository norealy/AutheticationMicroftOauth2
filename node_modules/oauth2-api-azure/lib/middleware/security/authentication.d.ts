import express from "express";
import { TokenResponse, ErrorResponse } from "adal-node";
import { IAuthSettings, IPassportOptions, SecurityStrategies } from "../../types";
import * as MicrosoftGraph from "@microsoft/microsoft-graph-types";
export declare class OAuthMiddleware {
    private app;
    private authRedirectUri;
    private signInUrl;
    private refreshTokenUrl;
    private authSettings;
    private passportAuthOptions;
    private baseAuthRoute;
    constructor(authSettings: IAuthSettings, passportOptions: IPassportOptions, hostname: string, baseAuthRoute: string);
    setAppHandler(app: express.Express): express.Express;
    authenticate(securityStrategy: SecurityStrategies): (request: any, response: any, next: any) => Promise<any>;
    getAccessTokenSilently(resourceId: string, authCode?: string): Promise<TokenResponse | ErrorResponse>;
    getAllADGroups(): Promise<MicrosoftGraph.Group[]>;
    findIfUserIsMemberOfGroup(groupId: string, userDisplayName: string): Promise<boolean>;
    private tokenResponseHandler;
    private getGraphClient;
}
