{"version":3,"file":"authentication.js","sourceRoot":"","sources":["../../../src/middleware/security/authentication.ts"],"names":[],"mappings":"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"}